---
layout: post
title: "Private Profiles (.cfg, .ini, etc.) done right"
date:   2020-09-30 09:11:20 +0200
categories: VBA Office Excel
---

## Intoduction
A _PrivateProfile_ is the term used for information written to file in a [section] <value-name>=<value> structure. In other words typically for files in which configuration or initialisation information is stored. The technical means for this are functions available under names beginning PrivateProfile... Their interface is definitely worth an abstraction layer which only deals with the arguments: file, section, valuename and value. The following services, available in a Standard Module _mFile_ 

## Services

### Read Value
Syntax: `value = mFile.Value(file,section,value-name)`
### Write Value
Syntax: `mFile.Value(file,section,value-name) = value`

### ValueExists
Syntax: `If mFile.ValueExists(file, section, value) Then`
### NameExists
Syntax: `If mFile.NameExists(file[, section], valuename) Then`

### SectionExists
Syntax: `If mFile.SectionExists(file) Then`

### SectionsCopy
Syntax: `mFile.SectionsCopy source, target, sections`

## Installation
- Download and import [mFile.bas][1]
- Download and import [mDct.bas][2]
- 
## Usage
The services may best be used in a Standard Module dedicated to the required application specific services regarding a file with a [section] valuename=value structure. Each value should be a Property

Example for reading a property called Root folder in a module called mCfg.
```VB
Option Explicit

Private Const CFG_SECTION = "Basic"
Private Const VAL_NAME_ROOT_FOLDER = "RootFolder"

Private Property Get CfgFile() As String
    CfgFile = ......
End Property

Private Property Get RootFolder() As String
    RootFolder = mFile.Value(CfgFile, CFG_SECTION, VAL_NAME_ROOT_FOLDER)
End Property

```
The use in the project now looks very clear:
`sRoot = mCfg.RootFolder`

A perfect example for a modules each implementing a higher abstraction layer. Each module serves for something and hides it's means.  

[1]:https://gitcdn.link/repo/warbe-maker/Common-VBA-File-Services/master/mFile.bas
[2]:https://gitcdn.link/repo/warbe-maker/Common-VBA-Dirctory-Services/master/mDct.bas